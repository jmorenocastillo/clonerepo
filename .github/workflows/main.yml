name: Main con nombre dinÃ¡mico

on: [push]

jobs:
  # Paso 1: Generar nombre
  prepare-job1:
    runs-on: ubuntu-latest
    outputs:
      job_name: ${{ steps.set.outputs.job_name }}
    steps:
      - name: Set name
        id: set
        run: echo "job_name=job1" >> $GITHUB_OUTPUT

  # Paso 2: Llamar reusable
  call-job1:
    needs: prepare-job1
    uses: ./.github/workflows/reusable.yml
    with:
      caller_job: ${{ needs.prepare-job1.outputs.job_name }}

  # Repite para job2, job3...
  prepare-job2:
    needs: call-job1
    runs-on: ubuntu-latest
    outputs:
      job_name: ${{ steps.set.outputs.job_name }}
    steps:
      - id: set
        run: echo "job_name=job2" >> $GITHUB_OUTPUT

  call-job2:
    needs: prepare-job2
    uses: ./.github/workflows/reusable.yml
    with:
      caller_job: ${{ needs.prepare-job2.outputs.job_name }}