name: Terraform Dummy - Manual Approval (Jenkins Style)

on:
  push:
    branches: [ main ]

jobs:
  terraform:
    runs-on: ubuntu-latest
    permissions:
      issues: write  # Para crear/actualizar el issue de aprobaci√≥n
    
    steps:
    - name: Checkout
      uses: actions/checkout@v4
    
    - name: Plan
      id: plan
      run: |
        echo "=== üó∫Ô∏è TERRAFORM PLAN (Dummy) ==="
        echo "## Plan Details" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        cat << 'EOF' >> $GITHUB_STEP_SUMMARY




    # ‚è∏Ô∏è PAUSA REAL - SE CONGELA HASTA APPROVE
    - name: ‚è∏Ô∏è Manual Approval Required
      if: github.ref == 'refs/heads/main'
      uses: trstringer/manual-approval@v1
      with:
        secret: ${{ github.TOKEN }}
        approvers: jmorenocastillo  # ‚Üê CAMBIA POR TU USERNAME
        minimum-approvals: 1
        issue-title: "üöÄ Aprobar Terraform Apply (Dummy)"
        issue-body: |
          ## üé≠ Plan Listo para Revisar
          
          **Commit:** `${{ github.sha }}`
          **Run:** [Ver Logs](https://github.com/${{ github.repository }}/actions/runs/${{ github.run_id }})
          
          ### üìã Detalles del Plan: